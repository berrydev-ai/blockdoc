{"version":3,"file":"sanitize.js","sources":["../../../src/utils/sanitize.js"],"sourcesContent":["/**\n * BlockDoc HTML Sanitization\n * \n * Provides utilities for sanitizing HTML content\n */\n\n/**\n * Simple HTML sanitizer to prevent XSS\n * @param {string} html - HTML content to sanitize\n * @returns {string} Sanitized HTML\n */\nexport function sanitizeHtml(html) {\n  if (!html) return '';\n  \n  const map = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#039;'\n  };\n  \n  return String(html).replace(/[&<>\"']/g, function(m) { return map[m]; });\n}\n\n/**\n * Sanitize a URL for safe embedding\n * @param {string} url - URL to sanitize\n * @returns {string} Sanitized URL\n */\nexport function sanitizeUrl(url) {\n  if (!url) return '';\n  \n  // Only allow http and https protocols\n  if (url.match(/^https?:\\/\\//i)) {\n    return url;\n  } else if (url.startsWith('//')) {\n    return `https:${url}`;\n  } else if (!url.includes(':')) {\n    // Relative URLs are considered safe\n    return url;\n  }\n  \n  // Default to empty for potentially unsafe protocols\n  return '';\n}"],"names":["sanitizeHtml","html","map","String","replace","m","sanitizeUrl","url","match","startsWith","includes"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASA,YAAYA,CAACC,IAAI,EAAE;AACjC,EAAA,IAAI,CAACA,IAAI,EAAE,OAAO,EAAE;AAEpB,EAAA,MAAMC,GAAG,GAAG;AACV,IAAA,GAAG,EAAE,OAAO;AACZ,IAAA,GAAG,EAAE,MAAM;AACX,IAAA,GAAG,EAAE,MAAM;AACX,IAAA,GAAG,EAAE,QAAQ;AACb,IAAA,GAAG,EAAE;GACN;EAED,OAAOC,MAAM,CAACF,IAAI,CAAC,CAACG,OAAO,CAAC,UAAU,EAAE,UAASC,CAAC,EAAE;IAAE,OAAOH,GAAG,CAACG,CAAC,CAAC;AAAE,GAAC,CAAC;AACzE;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASC,WAAWA,CAACC,GAAG,EAAE;AAC/B,EAAA,IAAI,CAACA,GAAG,EAAE,OAAO,EAAE;;AAEnB;AACA,EAAA,IAAIA,GAAG,CAACC,KAAK,CAAC,eAAe,CAAC,EAAE;AAC9B,IAAA,OAAOD,GAAG;GACX,MAAM,IAAIA,GAAG,CAACE,UAAU,CAAC,IAAI,CAAC,EAAE;IAC/B,OAAO,CAAA,MAAA,EAASF,GAAG,CAAE,CAAA;GACtB,MAAM,IAAI,CAACA,GAAG,CAACG,QAAQ,CAAC,GAAG,CAAC,EAAE;AAC7B;AACA,IAAA,OAAOH,GAAG;AACZ;;AAEA;AACA,EAAA,OAAO,EAAE;AACX;;;;;"}